<!DOCTYPE html>
<html>
<head>
  <title>Shared Memory Race</title>
</head>
<body>
  <h1>Race Condition on Shared Element</h1>
  <button onclick="startRace()">Start Race</button>

  <div id="sharedDiv">Shared Element</div>

  <iframe id="frame1" src="" style="width: 49%; height: 200px; border: 1px solid black;"></iframe>
  <iframe id="frame2" src="" style="width: 49%; height: 200px; border: 1px solid black;"></iframe>

  <script>
    const sharedDiv = document.getElementById("sharedDiv");
    window.sharedRef = sharedDiv;

    function startRace() {
      const r = Math.random();
      document.getElementById("frame1").src = "page1.html?r=" + r;
      setTimeout(() => {
        document.getElementById("frame2").src = "page2.html?r=" + r;
      }, 1);
    }
  </script>
</body>
</html>